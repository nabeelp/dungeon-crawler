# Orchestration Log: Leonard (Combat)

**Timestamp:** 2026-02-26T09:30:00Z  
**Status:** DONE  

## Changes Implemented

### Bug #1: Double XP / Level-Up Fix
- Made `CombatSystem.onKill()` and `CombatSystem.checkLevelUp()` canonical XP/level-up path
- Both now exported on `window.CombatSystem`
- Howard will remove duplicate award from main.js

### Bug #4: Loot Drop Wiring
- `onKill()` now calls `ItemSystem.dropLoot(victim, victim.floor)` with guard
- `dropLoot` handles ground item placement and messages internally

### Bug #5: Buff Tick Wiring (depends on Howard)
- Already set up in combat.js; waiting for Howard to call `tickBuffs()` per turn

### checkLevelUp Stat Gains Update
- Changed from +8 HP/+4 mana/+4 stamina/+2 atk/+1 def/+1 spd
- To +10 HP (partial heal)/+3 mana/+3 stamina/+1 atk/+1 def (no speed)
- Partial heal formula: `entity.hp = Math.min(entity.hp + 10, entity.maxHp)`

## Files Modified
- `src/systems/combat.js` â€” checkLevelUp stats, onKill loot call, export onKill

## Dependencies
- Depends on Howard to remove duplicate XP from main.js
- Depends on Howard to wire tickBuffs() calls per turn
- Depends on Sheldon for entity schema expansion (statusEffects, tags, xpValue)
- Decision files: `.squad/decisions/inbox/leonard-xp-droploot.md`

# Orchestration Log: Howard (Rendering)

**Timestamp:** 2026-02-26T09:30:00Z  
**Status:** DONE  

## Changes Implemented

### Bug #1: Remove Double XP Award
- Removed `player.xp += (target.level || 1) * 10` from `tryMove()` after meleeAttack kill
- Removed `checkLevelUp()` call from same location
- CombatSystem.onKill() is now single source of truth for XP/leveling
- Fallback path (no CombatSystem loaded) unchanged

### Bug #3: Wire ItemSystem.init()
- Added `ItemSystem.init(idRng)` in `startNewGame()` after `GameState.newGame()` and before monster/item generation
- Uses seed offset +999 to avoid RNG collision with monster spawning (seed) and item placement (seed+500)

### Bug #5: Wire ItemSystem.tickBuffs()
- Added `ItemSystem.tickBuffs()` calls in `processPlayerAction()` after enemy turns
- Ticks player first, then all alive non-player entities on current floor
- Placed before regeneration so buff expiry happens first

### Bug #6: Save/Load Identification State
- In `saveGame()`: Added capture of identification state via `ItemSystem.getIdentificationState()` guard
- In `loadGame()`: Added restore via `ItemSystem.restoreIdentificationState()` guard
- Both use defensive `window.ItemSystem && method` checks for graceful degradation

## Files Modified
- `src/main.js` â€” startNewGame, processPlayerAction, saveGame, loadGame

## Dependencies
- Depends on Sheldon for ItemSystem.getIdentificationState/restoreIdentificationState API
- Depends on Leonard for updated checkLevelUp stat gains (reflected in test expectations)
- Depends on Raj for ItemSystem.dropLoot, tickBuffs APIs
- Decision file: `.squad/decisions/inbox/howard-mainjs-fixes.md`
